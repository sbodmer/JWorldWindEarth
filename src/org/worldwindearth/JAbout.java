/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package org.worldwindearth;

import gov.nasa.worldwind.WorldWind;
import gov.nasa.worldwind.cache.FileStore;
import java.awt.Desktop;
import java.io.File;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import javax.swing.event.HyperlinkEvent;
import javax.swing.event.HyperlinkListener;
import org.tinyrcp.App;
import org.tinyrcp.TinyFactory;

/**
 *
 * @author sbodmer
 */
public class JAbout extends javax.swing.JDialog implements HyperlinkListener {

	/**
	 * Creates new form JAbout
	 */
	public JAbout(java.awt.Frame parent, boolean modal, App app) {
		super(parent, modal);

		initComponents();

		String txt = "";
		ArrayList<String> cont = new ArrayList<>();
		ArrayList<TinyFactory> factories = app.getFactories(null);
		for (int i = 0;i < factories.size();i++) {
			TinyFactory fac = factories.get(i);
			String author = (String) fac.getProperty(TinyFactory.PROPERTY_AUTHOR);
			if (author == null) continue;
			if (!cont.contains(author)) {
				txt += "" + author + "\n";
				cont.add(author);
			}

		}
		TA_Contributors.setText(txt);
		TA_Contributors.setCaretPosition(0);

		try {
			FileStore fs = WorldWind.getDataFileStore();
			List<? extends File> list = fs.getLocations();
			StringBuilder b = new StringBuilder("");
			b.append("WorldWind cache paths\n");
			for (int i = 0;i < list.size();i++) {
				File files = list.get(i);
				b.append(" " + files.getPath() + " (exists=" + files.exists() + ")\n");
			}
			b.append("\n");
			b.append("WorldWind layers jar paths (place your layer jars here)\n");
			b.append(" "+System.getProperty("user.dir")+"\n");
			b.append(" "+System.getProperty("user.home")+""+File.separator+".WorldWindEarth\n");
			TA_Paths.setText(b.toString());
			TA_Paths.setCaretPosition(0);
			
		} catch (NullPointerException ex) {
			ex.printStackTrace();
		}

		TP_WorldWind.addHyperlinkListener(this);

		try {
			URL url = getClass().getResource("/app/Resources/CHANGELOG.TXT");
			TP_ChangeLog.setPage(url);
			TP_ChangeLog.setCaretPosition(0);

		} catch (Exception ex) {
			ex.printStackTrace();
		}
	}

	//**************************************************************************
	//*** HyperlinkListener
	//**************************************************************************
	@Override
	public void hyperlinkUpdate(HyperlinkEvent e) {
		if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
			try {
				Desktop dt = Desktop.getDesktop();
				dt.browse(e.getURL().toURI());

			} catch (Exception ex) {

			}
		}
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	@SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        jScrollPane2 = new javax.swing.JScrollPane();
        TP_WorldWind = new javax.swing.JTextPane();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        TA_Paths = new javax.swing.JTextArea();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        TA_Contributors = new javax.swing.JTextArea();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jScrollPane5 = new javax.swing.JScrollPane();
        TP_ChangeLog = new javax.swing.JTextPane();
        jPanel4 = new javax.swing.JPanel();
        LB_Image = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("About");
        setPreferredSize(new java.awt.Dimension(480, 480));

        jTabbedPane1.setPreferredSize(new java.awt.Dimension(145, 200));

        TP_WorldWind.setEditable(false);
        TP_WorldWind.setContentType("text/html"); // NOI18N
        TP_WorldWind.setFont(new java.awt.Font("Monospaced", 0, 11)); // NOI18N
        TP_WorldWind.setText("<html>\n  <head>\n\n  </head>\n  <body>\n   <p style=\"margin-top: 0\">\n      Main project site<br>\n      <a href=\"https://github.com/sbodmer/JWorldWindEarth\">GitHub</a>\n    </p>\n    <br>\n    <p style=\"margin-top: 0\">\n      This application uses the Nasa WorldWind SDK<br>\n      <a href=\"https://worldwind.arc.nasa.gov\">Nasa worldwind home page</a>\n    </p>\n    <br>\n     <p style=\"margin-top: 0\">\n      3D models uses the libraries by \"robotfire\"<br>\n      <a href=\"https://github.com/robotfire/WorldWindObj\">WorldWindObj home page</a>\n    </p>\n    <br>\n    <p style=\"margin-top: 0\">\n      Flat look and feel<br>\n      <a href=\"https://www.formdev.com/flatlaf/\">FlatLaf</a>\n    </p>\n <br>\n    <p style=\"margin-top: 0\">\n      TinyRCP<br>\n      <a href=\"https://github.com/sbodmer/TinyRCP\">TinyRCP</a>\n    </p>\n<br>\n    <p style=\"margin-top: 0\">\n      OSMBuildingsTileServer<br>\n      <a href=\"https://github.com/sbodmer/OSMBuildingsTileServer\">OSMBuildingsTileServer</a>\n    </p>\n  </body>\n</html>\n");
        jScrollPane2.setViewportView(TP_WorldWind);

        jTabbedPane1.addTab("Projects", jScrollPane2);

        jPanel2.setLayout(new java.awt.BorderLayout());

        TA_Paths.setEditable(false);
        TA_Paths.setColumns(20);
        TA_Paths.setFont(new java.awt.Font("Monospaced", 0, 11)); // NOI18N
        TA_Paths.setRows(5);
        jScrollPane1.setViewportView(TA_Paths);

        jPanel2.add(jScrollPane1, java.awt.BorderLayout.CENTER);

        jTabbedPane1.addTab("Paths", jPanel2);

        jPanel1.setLayout(new java.awt.BorderLayout());

        TA_Contributors.setEditable(false);
        TA_Contributors.setColumns(20);
        TA_Contributors.setFont(new java.awt.Font("Monospaced", 0, 11)); // NOI18N
        TA_Contributors.setRows(5);
        jScrollPane3.setViewportView(TA_Contributors);

        jPanel1.add(jScrollPane3, java.awt.BorderLayout.CENTER);

        jTabbedPane1.addTab("Contributors", jPanel1);

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jTextArea1.setText("NASA WORLDWIND\n\nCopyright (C) 2001 United States Government\nas represented by the Administrator of the\nNational Aeronautics and Space Administration.\nAll Rights Reserved.\n\nNASA OPEN SOURCE AGREEMENT VERSION 1.3\n\nThis open source agreement (\"agreement\") defines the rights of use, reproduction,\ndistribution, modification and redistribution of certain computer software originally\nreleased by the United States Government as represented by the Government Agency\nlisted below (\"Government Agency\"). The United States Government, as represented by\nGovernment Agency, is an intended third-party beneficiary of all subsequent\ndistributions or redistributions of the subject software. Anyone who uses, reproduces,\ndistributes, modifies or redistributes the subject software, as defined herein, or any\npart thereof, is, by that action, accepting in full the responsibilities and obligations\ncontained in this agreement.\n\nGovernment Agency: National Aeronautics and Space Administration (NASA)\nGovernment Agency Original Software Designation: ARC-15166-1\nGovernment Agency Original Software Title: NASA WorldWind\nUser Registration Requested. Please send email with your contact information to Patrick.Hogan@nasa.gov\nGovernment Agency Point of Contact for Original Software: Patrick.Hogan@nasa.gov\n\nYou may obtain a full copy of the license at:\n\n    https://worldwind.arc.nasa.gov/LICENSE.html");
        jTextArea1.setCaretPosition(0);
        jScrollPane4.setViewportView(jTextArea1);

        jTabbedPane1.addTab("Nasa WorldWind", jScrollPane4);

        TP_ChangeLog.setFont(new java.awt.Font("Monospaced", 0, 11)); // NOI18N
        jScrollPane5.setViewportView(TP_ChangeLog);

        jTabbedPane1.addTab("ChangeLog", jScrollPane5);

        getContentPane().add(jTabbedPane1, java.awt.BorderLayout.CENTER);

        jPanel4.setLayout(new java.awt.BorderLayout());

        LB_Image.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        LB_Image.setIcon(new javax.swing.ImageIcon(getClass().getResource("/org/worldwindearth/Resources/Images/cards_wwe.jpg"))); // NOI18N
        jPanel4.add(LB_Image, java.awt.BorderLayout.CENTER);

        jLabel1.setFont(new java.awt.Font("Arial", 0, 24)); // NOI18N
        jLabel1.setText("JWorldWindEarth");
        jPanel3.add(jLabel1);

        jPanel4.add(jPanel3, java.awt.BorderLayout.NORTH);

        getContentPane().add(jPanel4, java.awt.BorderLayout.NORTH);

        setBounds(0, 0, 741, 582);
    }// </editor-fold>//GEN-END:initComponents


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel LB_Image;
    private javax.swing.JTextArea TA_Contributors;
    private javax.swing.JTextArea TA_Paths;
    private javax.swing.JTextPane TP_ChangeLog;
    private javax.swing.JTextPane TP_WorldWind;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTextArea jTextArea1;
    // End of variables declaration//GEN-END:variables

}
